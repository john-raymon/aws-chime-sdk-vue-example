(function(e){function t(t){for(var o,a,u=t[0],s=t[1],c=t[2],d=0,h=[];d<u.length;d++)a=u[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&h.push(r[a][0]),r[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,u=1;u<n.length;u++){var s=n[u];0!==r[s]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"126e":function(e,t,n){},4475:function(e,t,n){"use strict";var o=n("8d4e"),r=n.n(o);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("a026"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.layout,{tag:"component",attrs:{userAuth:e.userAuth},on:{"log-out":e.handleLogout}},[n("router-view",{attrs:{userAuth:e.userAuth}})],1)},i=[],a=n("5530"),u=n("94ea"),s={name:"App",computed:Object(a["a"])({layout:function(){return this.$route.meta.layout||"default-layout"}},Object(u["c"])(["userAuth"])),methods:Object(a["a"])(Object(a["a"])({},Object(u["b"])(["logout"])),{},{handleLogout:function(){var e=this;this.logout().then((function(){e.$nextTick().then((function(){e.$router.push({name:"sign-in"})}))}))}})},c=s,l=n("2877"),d=Object(l["a"])(c,r,i,!1,null,null,null),h=d.exports,f=n("8c4f"),p=(n("45fc"),n("b0c0"),n("96cf"),n("1da1")),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-full"},[n("div",{staticClass:"py-10 mx-auto"},[n("h2",[e._v(" Gatherly Meeting ")]),n("p",[e._v("Create a meeting room (you'll receive an invite link for others to join)")]),n("router-link",{staticClass:"block button text-center",attrs:{to:"/join?create=true"}},[e._v(" Create a new meeting ")])],1)])},g=[],v={name:"HomePage"},b=v,y=(n("933a"),Object(l["a"])(b,m,g,!1,null,null,null)),O=y.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"meeting-room w-full flex justifty-center items-center"},[e.meetingSession||e.error?e.meetingSession&&!e.error?[n("div",{staticClass:"flex flex-col py-10"},[n("p",[e._v("Meeting room")]),n("audio",{ref:"audioElement"}),n("div",{staticClass:"flex flex-col w-1/2"},[n("video",{ref:"defaultVideoElement",staticClass:"block"}),n("video",{ref:"attendeeVideoElement",staticClass:"block"})])])]:e.error?[n("p",{staticClass:"mx-auto text-red-500"},[e._v("Oops, there was an error connecting you to this room.")])]:e._e():[n("p",{staticClass:"mx-auto"},[e._v("Joining a meeting...")])]],2)},w=[],A=n("b40d"),_={name:"MeetingRoom",data:function(){return{meetingSession:null,audioVideo:null,joinInfo:null,error:null,enableWebAudio:!0}},created:function(){console.log("created() called"),this.$route.query.create||this.$route.params.meetingTitle?this.fetchOrCreateMeetingAndAttendee():this.$router.push("/")},methods:{fetchOrCreateMeetingAndAttendee:function(){var e=this,t=this.$route.query.create?"/join":"/join/".concat(this.$route.params.meetingTitle);this.$http._post(t,null,!0).then((function(t){e.joinInfo=t.joinInfo,e.$route.params.meetingTitle||history.pushState({},null,e.$route.path+"/"+encodeURIComponent(e.joinInfo.meeting.ExternalMeetingId)),e.initMeetingSession(e.joinInfo),console.log({joinInfo:t.joinInfo})})).catch((function(t){e.error=t}))},initMeetingSession:function(e){var t=new A["MeetingSessionConfiguration"](e.meeting,e.attendee),n=new A["ConsoleLogger"]("SDK",A["LogLevel"].DEBUG),o=new A["DefaultDeviceController"](n);t.enableWebAudio=this.enableWebAudio,this.meetingSession=new A["DefaultMeetingSession"](t,n,o),this.audioVideo=this.meetingSession.audioVideo,this.setUpDevicesAndStart()},setUpDevicesAndStart:function(){var e=this,t={videoTileDidUpdate:function(t){console.log({tileState:t});var n=e.$refs.audioElement,o=1===t.tileId;e.audioVideo.bindAudioElement(n),e.audioVideo.bindVideoElement(t.tileId,o?e.$refs.defaultVideoElement:e.$refs.attendeeVideoElement)},audioVideoDidStart:function(){console.log("Started")},audioVideoDidStop:function(e){console.log("Stopped with a session status code: ",e.statusCode())},audioVideoDidStartConnecting:function(e){e&&console.log("Attempting to reconnect")}};this.audioVideo.listAudioInputDevices().then((function(t){return e.audioVideo.chooseAudioInputDevice(t[0].deviceId)})).then((function(){return e.audioVideo.listAudioOutputDevices()})).then((function(t){return e.audioVideo.chooseAudioOutputDevice(t.length?t[0].deviceId:null)})).then((function(){var t=e.$refs.audioElement;return e.audioVideo.bindAudioElement(t)})).then((function(){return e.audioVideo.addObserver(t),e.audioVideo.start()})).then((function(){e.audioVideo.listVideoInputDevices().then((function(t){return e.audioVideo.chooseVideoInputDevice(t.length?t[0].deviceId:null)})).then((function(){return e.audioVideo.startLocalVideoTile()}))})).then((function(){var t=e.audioVideo.realtimeUnmuteLocalAudio();t?console.log("Other attendees can hear your audio"):console.log("You cannot unmute yourself");var n=e.audioVideo.realtimeIsLocalAudioMuted();n?console.log("You are muted"):console.log("Other attendees can hear your audio")})).catch((function(t){console.log("error",t),e.error=Object(a["a"])(Object(a["a"])({},t),{},{message:"There was an error setting up your audio inputs"})}))}}},k=_,x=Object(l["a"])(k,j,w,!1,null,null,null),V=x.exports,T=n("bfa9"),I=(n("99af"),n("d4ec")),S=n("bee2"),C=n("db82"),$=n.n(C),E=n("a002"),D=n.n(E),M=n("bc3a"),R=n.n(M),P=n("4328"),U=n.n(P),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";Object(I["a"])(this,e),this.API_ROOT=t,this.superagent=$.a,this.axios=R.a,this.axios.interceptors.request.use(function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getToken();case 2:return o=t.sent,n.headers.Authorization="Token ".concat(o),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}return Object(S["a"])(e,[{key:"_tokenPlugin",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getToken();case 3:return this.token=t.sent,n.set("Authorization","Token ".concat(this.token||"")),t.abrupt("return",n);case 8:return t.prev=8,t.t0=t["catch"](0),console.log("Error while fetching token from storage.",t.t0),t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this,[[0,8]])})));function n(e){return t.apply(this,arguments)}return n}()},{key:"_responseBody",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(n){var o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=n.data.user||n.data.merchant||{},r=o.accessToken,!r){t.next=4;break}return t.next=4,e.setToken(r);case 4:return t.abrupt("return",n.data);case 5:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()},{key:"_del",value:function(e){return this.superagent.del("".concat(this.API_ROOT).concat(e)).then(this._responseBody)}},{key:"_get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return R.a.get(t?e:"".concat(this.API_ROOT).concat(e),U.a.stringify(n)).then(this._responseBody)}},{key:"_patch",value:function(e,t){return this.superagent.patch("".concat(this.API_ROOT).concat(e),t).then(this._responseBody)}},{key:"_post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return R.a.post(n?e:"".concat(this.API_ROOT).concat(e),t).then(this._responseBody)}}],[{key:"getToken",value:function(){return D.a.getItem("jwt")}},{key:"setToken",value:function(e){return D.a.setItem("jwt",e)}}]),e}(),q=L;o["a"].use(u["a"]);var B=new T["a"],J=new u["a"].Store({state:{userAuth:{isAuth:!1,user:null}},mutations:{setUserAuth:function(e,t){e.userAuth=Object(a["a"])(Object(a["a"])({},t),{},{user:Object(a["a"])(Object(a["a"])({},t.user),{},{accessToken:void 0})})},resetAuth:function(e){e.userAuth={isAuth:!1,user:null}}},actions:{updateUserAuth:function(e,t){e.commit("setUserAuth",t)},logout:function(e){return q.setToken(""),e.commit("resetAuth")}},plugins:[B.plugin]}),W=[{name:"home",path:"",component:O},{name:"meeting-room",path:"/join/:meetingTitle?",alias:"/join/:meetingTitle",component:V}],z=new f["a"]({routes:W,mode:"history"});z.beforeEach(function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t,n,o){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=J.state.userAuth.isAuth,t.matched.some((function(e){return e.meta.requireUserAuth}))?r?o():o({name:"login",query:Object(a["a"])(Object(a["a"])({},t.query),{},{redirect:t.name})}):o();case 2:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}());var G=z,Y=(n("4160"),n("159b"),n("3835"));function H(e,t){var n=t.components,o=void 0!==n&&n;o&&o.forEach((function(t){var n=Object(Y["a"])(t,2),o=n[0],r=n[1];o&&r&&e.component(o,r)}))}var K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"default-layout"},[n("main",{staticClass:"main"},[e._t("default")],2),e._m(0)])},F=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",{staticClass:"w-full flex justify-center text-gray-800 text-xs tracking-widest py-10"},[n("a",{attrs:{href:"https://github.com/john-raymon",target:"_blank"}},[e._v(" Made with ðŸ’“love by https://github.com/john-raymon ")])])}],N={name:"DefaultLayout",props:["userAuth"]},Q=N,X=(n("4475"),Object(l["a"])(Q,K,F,!1,null,null,null)),Z=X.exports;n("ba8c");o["a"].use(f["a"]),o["a"].use(H,{components:[["default-layout",Z]]}),o["a"].mixin({beforeCreate:function(){this.$http=new q("/api")}}),o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(h)},router:G,store:J}).$mount("#app")},"8d4e":function(e,t,n){},"933a":function(e,t,n){"use strict";var o=n("126e"),r=n.n(o);r.a},ba8c:function(e,t,n){}});
//# sourceMappingURL=app.4b55f3f9.js.map